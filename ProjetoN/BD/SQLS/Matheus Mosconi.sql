/******************************************************************************/
/***          Generated by IBExpert 2012.02.21 15/11/2015 23:12:59          ***/
/******************************************************************************/

SET SQL DIALECT 3;

SET NAMES NONE;

SET CLIENTLIB 'D:\Faculdade\Algoritmo - Rodney\Banco\gds32.dll';

CREATE DATABASE 'D:\Faculdade\Algoritmo - Rodney\Banco\ControlePatrimonial.fdb'
USER 'SYSDBA' PASSWORD 'masterkey'
PAGE_SIZE 16384
DEFAULT CHARACTER SET NONE;



/******************************************************************************/
/***                                 Tables                                 ***/
/******************************************************************************/



CREATE TABLE BENS_IMOBILIZADOS (
    BNI_EMPRESA             INTEGER NOT NULL,
    BNI_CODIGO              INTEGER NOT NULL,
    BNI_NUM_SERIE           INTEGER NOT NULL,
    BNI_NR_NOTA             INTEGER NOT NULL,
    BNI_FORNECEDOR          INTEGER NOT NULL,
    BNI_DESCRICAO           VARCHAR(100) NOT NULL,
    BNI_TIPO                INTEGER NOT NULL,
    BNI_LOCALIZACAO         INTEGER NOT NULL,
    BNI_ESTADO_CONSERVACAO  INTEGER NOT NULL,
    BNI_MANUTENCAO          INTEGER,
    BNI_DATA_AQUISICAO      DATE NOT NULL,
    BNI_VLR_AQUISICAO       FLOAT DEFAULT 0 NOT NULL,
    BNI_VLR_AGREGADO        FLOAT default 0 NOT NULL,
    BNI_VLR_ATUAL           FLOAT DEFAULT 0 NOT NULL,
    BNI_DEPRECIACAO         FLOAT DEFAULT 0 NOT NULL,
    BNI_OBSERVACAO          BLOB SUB_TYPE 0 SEGMENT SIZE 80,
    BNI_STATUS              VARCHAR(1) default 'A' NOT NULL
);

CREATE TABLE COMPONENTE (
    COM_EMPRESA         INTEGER NOT NULL,
    COM_MANUTENCAO      INTEGER NOT NULL,
    COM_CODIGO          VARCHAR(30) NOT NULL,
    COM_OBSERVACAO      BLOB SUB_TYPE 0 SEGMENT SIZE 80,
    COM_VLR_COMPONENTE  FLOAT DEFAULT 0 NOT NULL
);

CREATE TABLE EMPRESA (
    EMP_COD       INTEGER NOT NULL,
    EMP_CNPJ      INTEGER,
    EMP_RAZAO     VARCHAR(60),
    EMP_NOMEF     VARCHAR(60),
    EMP_ENDERECO  VARCHAR(60),
    EMP_END_NUM   INTEGER,
    EMP_BAIRRO    VARCHAR(20),
    EMP_CIDADE    VARCHAR(60),
    EMP_UF        VARCHAR(2),
    EMP_CEP       INTEGER,
    EMP_FONE      VARCHAR(10),
    EMP_TITULAR   VARCHAR(60)
);

CREATE TABLE ESTADO_DE_CONSERVACAO (
    EDC_CODIGO     INTEGER NOT NULL,
    EDC_DESCRICAO  VARCHAR(100) NOT NULL,
    EDC_STATUS     VARCHAR(1) default 'A' NOT NULL
);

CREATE TABLE LOCALIZACAO (
    LOC_CODIGO     INTEGER NOT NULL,
    LOC_DESCRICAO  VARCHAR(100) NOT NULL,
    LOC_STATUS     VARCHAR(1) DEFAULT 'A' NOT NULL
);

CREATE TABLE MANUTENCAO (
    MAN_EMPRESA         INTEGER NOT NULL,
    MAN_CODIGO          INTEGER NOT NULL,
    MAN_BEN             INTEGER NOT NULL,
    MAN_DESCRICAO       VARCHAR(100) NOT NULL,
    MAN_OBSERVACAO      BLOB SUB_TYPE 0 SEGMENT SIZE 80,
    MAN_VLR_COMPONENTE  FLOAT DEFAULT 0 NOT NULL,
    MAN_VLR_MANUTENCAO  FLOAT DEFAULT 0 NOT NULL,
    MAN_VLR_TOTAL       FLOAT DEFAULT 0 NOT NULL,
    MAN_AGREGA_CUSTO    VARCHAR(1) DEFAULT 'S' NOT NULL,
    MAN_NUM_SERIE       INTEGER NOT NULL
);

CREATE TABLE NOTA_ENTRADA (
    NTE_EMPRESA    INTEGER NOT NULL,
    NTE_NR_NOTA    INTEGER NOT NULL,
    NTE_PESSOA     INTEGER NOT NULL,
    NTE_DATA       DATE NOT NULL,
    NTE_VLR_FRETE  NUMERIC(18,2) DEFAULT 0.00 NOT NULL,
    NTE_VLR_PIS    NUMERIC(18,2) DEFAULT 0.00 NOT NULL,
    NTE_VLR_ICMS   NUMERIC(18,2) DEFAULT 0.00 NOT NULL,
    NTE_VLR_TOTAL  NUMERIC(18,2) DEFAULT 0.00 NOT NULL
);

CREATE TABLE NUM_SERIE_BENS (
    NSB_EMPRESA  INTEGER NOT NULL,
    NSB_CODIGO   INTEGER NOT NULL,
    NSB_STATUS   VARCHAR(1) DEFAULT 'A' NOT NULL
);

CREATE TABLE PESSOAS (
    PESS_CODIGO         INTEGER NOT NULL,
    PESS_NOME           VARCHAR(100),
    PESS_TIPO           CHAR(1),
    PESS_APELIDO        VARCHAR(60),
    PESS_CONTATO        VARCHAR(60),
    PESS_TELCONTATO     VARCHAR(15),
    PESS_TEL1           VARCHAR(15),
    PESS_TEL2           VARCHAR(15),
    PESS_TEL3           VARCHAR(15),
    PESS_FAX            VARCHAR(12),
    PESS_RAMAL          INTEGER,
    PESS_CNPJ           VARCHAR(14),
    PESS_CPF            VARCHAR(11),
    PESS_RG             VARCHAR(10),
    PESS_INSCESTADUAL   VARCHAR(9),
    PESS_INSCMUNICIPAL  VARCHAR(15),
    PESS_EMAIL          VARCHAR(60),
    PESS_DTCADASTRO     TIMESTAMP NOT NULL,
    PESS_LOGRADOURO     VARCHAR(60),
    PESS_BAIRRO         VARCHAR(30),
    PESS_COMPLEMENTO    VARCHAR(30),
    PESS_NR             VARCHAR(5),
    PESS_CIDADE         VARCHAR(20) DEFAULT 'PR',
    PESS_UF             VARCHAR(2),
    PESS_PAIS           VARCHAR(20) DEFAULT 'BRASIL'
);

CREATE TABLE PRODUTOS (
    PRO_EMPRESA       INTEGER NOT NULL,
    PRO_CODIGO        VARCHAR(30) NOT NULL,
    PRO_CODREF        VARCHAR(30),
    PRO_CODBARRAS     VARCHAR(60),
    PRO_STATUS        VARCHAR(5) DEFAULT 'A',
    PRO_DTCADASTRO    DATE DEFAULT CURRENT_DATE,
    PRO_CLASSFISCAL   VARCHAR(30),
    PRO_CSTCSOSN      VARCHAR(30),
    PRO_NCMSH         VARCHAR(30),
    PRO_EXTIPI        VARCHAR(30),
    PRO_SITTRIB       VARCHAR(30),
    PRO_PIS           VARCHAR(20),
    PRO_COFINS        VARCHAR(18),
    PRO_CSTPIS        VARCHAR(18),
    PRO_ESTATUAL      VARCHAR(20),
    PRO_DESCRICAO     VARCHAR(60) NOT NULL,
    PRO_UNID          INTEGER,
    PRO_MARCA         INTEGER,
    PRO_MOEDA         VARCHAR(10),
    PRO_CATEGORIA     INTEGER NOT NULL,
    PRO_PESO          NUMERIC(18,2) DEFAULT 0.0,
    PRO_CUSTOMEDIO    NUMERIC(18,2) DEFAULT 0.0,
    PRO_VALORIZACAO   NUMERIC(18,2) DEFAULT 0.0,
    PRO_VLRFRETE      NUMERIC(18,2) DEFAULT 0.0,
    PRO_PERCENCARG    NUMERIC(18,2) DEFAULT 0.0,
    PRO_VLRENCARG     NUMERIC(18,2) DEFAULT 0.0,
    PRO_PERCMARGLUCR  NUMERIC(18,2) DEFAULT 0.0,
    PRO_VLRMARGLUCR   NUMERIC(18,2) DEFAULT 0.0,
    PRO_VLRVENDA      NUMERIC(18,2) DEFAULT 0.0,
    PRO_OBS           VARCHAR(100),
    PRO_IMG           BLOB SUB_TYPE 0 SEGMENT SIZE 4096,
    PRO_GRUPO         CHAR(1)
);

CREATE TABLE TIPO_DE_BENS (
    TPB_CODIGO     INTEGER NOT NULL,
    TPB_DESCRICAO  VARCHAR(100) NOT NULL,
    TPB_STATUS     VARCHAR(1) default 'A' NOT NULL
);



/******************************************************************************/
/***                              Primary Keys                              ***/
/******************************************************************************/

ALTER TABLE BENS_IMOBILIZADOS ADD CONSTRAINT PK_BENS_IMOBILIZADOS PRIMARY KEY (BNI_EMPRESA, BNI_CODIGO, BNI_NUM_SERIE);
ALTER TABLE COMPONENTE ADD CONSTRAINT PK_COMPONENTE PRIMARY KEY (COM_EMPRESA, COM_CODIGO);
ALTER TABLE EMPRESA ADD CONSTRAINT PK_EMPRESA PRIMARY KEY (EMP_COD);
ALTER TABLE ESTADO_DE_CONSERVACAO ADD CONSTRAINT PK_ESTADO_DE_CONSERVACAO PRIMARY KEY (EDC_CODIGO);
ALTER TABLE LOCALIZACAO ADD CONSTRAINT PK_LOCALIZACAO PRIMARY KEY (LOC_CODIGO);
ALTER TABLE MANUTENCAO ADD CONSTRAINT PK_MANUTENCAO PRIMARY KEY (MAN_EMPRESA, MAN_CODIGO);
ALTER TABLE NOTA_ENTRADA ADD CONSTRAINT PK_NOTA_ENTRADA PRIMARY KEY (NTE_EMPRESA, NTE_NR_NOTA, NTE_PESSOA);
ALTER TABLE NUM_SERIE_BENS ADD CONSTRAINT PK_NUM_SERIE_BENS PRIMARY KEY (NSB_EMPRESA, NSB_CODIGO);
ALTER TABLE PESSOAS ADD CONSTRAINT PK_PESSOA PRIMARY KEY (PESS_CODIGO);
ALTER TABLE PRODUTOS ADD CONSTRAINT PK_PRODUTOS PRIMARY KEY (PRO_EMPRESA, PRO_CODIGO);
ALTER TABLE TIPO_DE_BENS ADD CONSTRAINT PK_TIPO_DE_BENS PRIMARY KEY (TPB_CODIGO);


/******************************************************************************/
/***                              Foreign Keys                              ***/
/******************************************************************************/

ALTER TABLE BENS_IMOBILIZADOS ADD CONSTRAINT FK_BENS_EMPRESA FOREIGN KEY (BNI_EMPRESA) REFERENCES EMPRESA (EMP_COD);
ALTER TABLE BENS_IMOBILIZADOS ADD CONSTRAINT FK_BENS_ESTCONSERVACAO FOREIGN KEY (BNI_ESTADO_CONSERVACAO) REFERENCES ESTADO_DE_CONSERVACAO (EDC_CODIGO);
ALTER TABLE BENS_IMOBILIZADOS ADD CONSTRAINT FK_BENS_LOCALIZACAO FOREIGN KEY (BNI_LOCALIZACAO) REFERENCES LOCALIZACAO (LOC_CODIGO);
ALTER TABLE BENS_IMOBILIZADOS ADD CONSTRAINT FK_BENS_NOTA FOREIGN KEY (BNI_EMPRESA, BNI_NR_NOTA, BNI_FORNECEDOR) REFERENCES NOTA_ENTRADA (NTE_EMPRESA, NTE_NR_NOTA, NTE_PESSOA);
ALTER TABLE BENS_IMOBILIZADOS ADD CONSTRAINT FK_BENS_NR_SERIE FOREIGN KEY (BNI_EMPRESA, BNI_NUM_SERIE) REFERENCES NUM_SERIE_BENS (NSB_EMPRESA, NSB_CODIGO);
ALTER TABLE BENS_IMOBILIZADOS ADD CONSTRAINT FK_BENS_TIPO FOREIGN KEY (BNI_TIPO) REFERENCES TIPO_DE_BENS (TPB_CODIGO);
ALTER TABLE COMPONENTE ADD CONSTRAINT FK_COMPONENTE_MANUTENCAO FOREIGN KEY (COM_EMPRESA, COM_MANUTENCAO) REFERENCES MANUTENCAO (MAN_EMPRESA, MAN_CODIGO);
ALTER TABLE COMPONENTE ADD CONSTRAINT FK_COMPONENTE_PRODUTO FOREIGN KEY (COM_EMPRESA, COM_CODIGO) REFERENCES PRODUTOS (PRO_EMPRESA, PRO_CODIGO);
ALTER TABLE MANUTENCAO ADD CONSTRAINT FK_MANUTENCAO_BENS FOREIGN KEY (MAN_EMPRESA, MAN_BEN, MAN_NUM_SERIE) REFERENCES BENS_IMOBILIZADOS (BNI_EMPRESA, BNI_CODIGO, BNI_NUM_SERIE);